# Architecture Avanc√©e du Syst√®me IDS
=======================================================

## Vue d'ensemble
Syst√®me de d√©tection d'intrusion avec support IPv4/IPv6 complet,
analyse avanc√©e des comportements r√©seau, et interface graphique professionnelle.

## Modules Principaux

=========================================================

üìÅ capture/
üåç Mission du dossier :
Capturer les paquets r√©seau √† partir d'interfaces syst√®me.

‚Ä¢ live_listener.py - Capture IPv4
  - Utilise scapy, pyshark, socket pour capture
  - Filtre les paquets IP
  - Callback pour traitement en temps r√©el

‚Ä¢ live_listener_adv.py - Capture Avanc√©e
  - Support des backends multiples
  - Capture IPv4/IPv6
  - Analyse de protocoles (ARP, DNS, ICMP)

‚Ä¢ helpers.py - Utilitaires de capture
  - Normalisation des paquets
  - Extraction de m√©tadonn√©es
  - Utilitaires r√©seau

=========================================================

üìÅ preprocessing/
‚öôÔ∏è Mission du dossier :
Normaliser et pr√©parer les paquets pour la d√©tection.

‚Ä¢ packet_parser.py
  - Analyse compl√®te des couches OSI
  - Extraction des champs pertinents
  - Normalisation des formats
  - Gestion des malformations

=========================================================

üìÅ detection/
üéØ Mission du dossier :
D√©tecter les attaques et comportements suspects.

‚Ä¢ engine.py - Moteur de d√©tection IPv4
  - Orchestre les d√©tecteurs
  - Applique les r√®gles personnalis√©es
  - G√©n√©ration des findings

‚Ä¢ arp_spoof_detector.py - D√©tection ARP Spoofing
  - Suivi IP ‚Üî MAC mappings
  - D√©tection d'incoh√©rences

‚Ä¢ syn_flood_detector.py - D√©tection SYN Flood
  - Comptage des paquets SYN
  - Seuils temporels

‚Ä¢ udp_flood_detector.py - D√©tection UDP Flood
  - Comptage des paquets UDP
  - D√©tection des volumes anormaux

‚Ä¢ xmas_null_scan_detector.py - D√©tection Port Scans
  - D√©tection XMAS (FIN+PSH+URG)
  - D√©tection NULL scans (no flags)

‚Ä¢ simple_detector.py - D√©tecteur de Taux G√©n√©rique
  - D√©tection bas√©e sur la fr√©quence
  - Fallback pour protocoles non sp√©cifiques

‚Ä¢ rule_engine.py - Moteur de R√®gles Personnalis√©es
  - √âvaluation des conditions
  - Application des actions

‚Ä¢ detection_ipv6.py - D√©tection Avanc√©e IPv6/IPv6
  - Analyse comportementale
  - D√©tection des attaques √©volu√©es
  - ARP Spoofing, SYN Scan/Flood
  - XMAS Scan, NULL Scan
  - UDP Flood, ICMP Flood
  - D√©tections DNS, ARP
  - Timeline et anomalies comportementales

=========================================================

üìÅ traffic_analyser.py
üìä Mission du fichier :
Analyser les patterns de trafic r√©seau.

Contient :
- Comptage des protocoles
- Comptage des IPs source/destination
- Analyse des requ√™tes DNS
- D√©tection du tri-way handshake TCP
- Usage des ports
- Baseline du trafic

=========================================================

üìÅ utils/
üîß Mission du dossier :
Support et utilitaires syst√®me.

‚Ä¢ config.py
  - Gestion de la configuration
  - Persistance des param√®tres
  - Thresholds

‚Ä¢ logger.py
  - Logging syst√®me
  - Journalisation des alertes

‚Ä¢ helpers.py
  - Utilitaires g√©n√©raux
  - Formatage et conversion

‚Ä¢ normalization.py
  - Normalisation des donn√©es
  - Standardisation des formats

=========================================================

üìÅ gui/
üåê Mission du dossier :
Interface graphique utilisateur.

‚Ä¢ capture_gui.py
  Interface graphique unifi√©e (IPv4 & IPv6). Fournit:
  - Capture de paquets en temps r√©el
  - Affichage des d√©tections (IPv4 & IPv6)
  - Alertes de s√©curit√© avanc√©es
  - Gestion des param√®tres
  - R√®gles personnalis√©es
  - Statistiques et graphiques
  - Analyse de baseline
  - Analytics avanc√©e

‚Ä¢ capture_gui_adv.py
  Version avanc√©e alternative avec features IPv6 √©tendues:
  - D√©tection IPv6 avanc√©e
  - Traffic analysis approfondie
  - Heatmaps temporelles
  - User authentication (RBAC)
  - Historique d√©taill√©

‚Ä¢ rules_manager.py
  Gestion des r√®gles personnalis√©es:
  - CRUD sur les r√®gles
  - Validation des r√®gles
  - Persistance (JSON)

‚Ä¢ ui_helpers.py
  Utilitaires UI:
  - Cr√©ation de widgets
  - Formatage des couleurs
  - Gestion des erreurs

=========================================================

üìÅ config/
üìã Mission du dossier :
Fichiers de configuration syst√®me.

‚Ä¢ config.json
  Param√®tres de d√©tection:
  - Seuils par profil (Low, Medium, High, Critical)
  - Configuration SIEM (JSON logging)
  - Notifications (popup, son)
  - Whitelist/Blacklist
  - Autres param√®tres

‚Ä¢ rules.json
  R√®gles de d√©tection personnalis√©es

=========================================================

üìÅ attacks/
üé≠ Mission du dossier :
Scripts de test et simulation d'attaques.

Scripts disponibles:
‚Ä¢ attack_arp_spoof.py - Simulation ARP Spoofing
‚Ä¢ attack_dns_anomaly.py - Anomalies DNS
‚Ä¢ attack_external_access.py - Acc√®s externes
‚Ä¢ attack_large_packet.py - Paquets surdimensionn√©s
‚Ä¢ attack_null_scan.py - NULL scan
‚Ä¢ attack_port_scan.py - Port scanning
‚Ä¢ attack_syn_flood.py - SYN flooding
‚Ä¢ attack_udp_flood.py - UDP flooding
‚Ä¢ attack_xmas_scan.py - XMAS scanning

=========================================================

üìÅ scripts/
üöÄ Mission du dossier :
Points d'entr√©e et runners.

‚Ä¢ runner_capture_adv.py
  Lanceur pour capture_gui_adv avec IPv6

Autres scripts divers:
‚Ä¢ traffic_analyser.py - Analyse ind√©pendante du trafic
‚Ä¢ detection_ipv6.py - D√©tection IPv6 ind√©pendante

=========================================================

## Architecture de Flux

Capture ‚Üí Preprocessing ‚Üí D√©tection ‚Üí Affichage GUI

1. Capture: Live listener capture les paquets
2. Preprocessing: Normalisation et extraction
3. D√©tection:
   - Engine IPv4 applique les d√©tecteurs
   - Rules engine v√©rifie les r√®gles personnalis√©es
   - IPv6 detector analyse les menaces avanc√©es
4. Affichage: GUI unifi√© montre tous les r√©sultats

=========================================================

## Profils de D√©tection

Low:     Sensibilit√© minimale (faux positifs bas)
Medium:  √âquilibre d√©tection/faux positifs
High:    Sensibilit√© √©lev√©e
Critical: Maximum de sensibilit√©

=========================================================

## Configurations Disponibles

SIEM: JSON logging pour int√©gration avec SIEM
Notifications: Alertes popup et sonores
RBAC: Contr√¥le d'acc√®s bas√© r√¥les
Syslog: Int√©gration syslog
Logging: Cryptage des logs (optionnel)

=========================================================
